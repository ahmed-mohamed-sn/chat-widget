!function(){window.mw=window.mw||new function(){this.config={},this.chatWindow=null,this.messageList=null,this.inputField=null,this.socket=null,this.init=function(t){this.config=t,this.loadConfig()},this.loadConfig=function(){fetch("http://localhost:8000/api/config/"+this.config.widgetId).then((t=>t.json())).then((t=>{this.render(t),this.connectWebSocket()})).catch((t=>console.error("Error loading configuration:",t)))},this.connectWebSocket=function(){this.socket=new WebSocket("ws://localhost:8000/ws/"+this.config.widgetId),this.socket.onopen=function(t){console.log("WebSocket connection established")},this.socket.onmessage=function(t){this.addMessage("Server",t.data)}.bind(this),this.socket.onclose=function(t){t.wasClean?console.log(`WebSocket connection closed cleanly, code=${t.code} reason=${t.reason}`):console.error("WebSocket connection died")},this.socket.onerror=function(t){console.error(`WebSocket error: ${t.message}`)}},this.render=function(t){switch(this.chatWindow=document.createElement("div"),this.chatWindow.id="my-chat-widget",this.chatWindow.style.position="fixed",this.chatWindow.style.width="300px",this.chatWindow.style.height="400px",this.chatWindow.style.backgroundColor=t.primary_color,this.chatWindow.style.color=t.secondary_color,this.chatWindow.style.fontFamily=t.font_family,this.chatWindow.style.display="flex",this.chatWindow.style.flexDirection="column",this.chatWindow.style.boxShadow="0 0 10px rgba(0,0,0,0.1)",this.chatWindow.style.borderRadius="10px",this.chatWindow.style.overflow="hidden",t.chat_position){case"bottom-right":this.chatWindow.style.bottom="20px",this.chatWindow.style.right="20px";break;case"bottom-left":this.chatWindow.style.bottom="20px",this.chatWindow.style.left="20px";break;case"top-right":this.chatWindow.style.top="20px",this.chatWindow.style.right="20px";break;case"top-left":this.chatWindow.style.top="20px",this.chatWindow.style.left="20px"}var e=document.createElement("div");e.style.padding="10px",e.style.backgroundColor=t.secondary_color,e.style.color=t.primary_color,e.innerHTML="<h3>"+t.welcome_message+"</h3>",this.chatWindow.appendChild(e),this.messageList=document.createElement("div"),this.messageList.style.flex="1",this.messageList.style.overflowY="auto",this.messageList.style.padding="10px",this.chatWindow.appendChild(this.messageList),this.inputField=document.createElement("input"),this.inputField.type="text",this.inputField.placeholder="Type your message...",this.inputField.style.width="100%",this.inputField.style.padding="10px",this.inputField.style.border="none",this.inputField.style.borderTop="1px solid "+t.secondary_color,this.inputField.addEventListener("keypress",this.handleInput.bind(this)),this.chatWindow.appendChild(this.inputField),document.body.appendChild(this.chatWindow)},this.handleInput=function(t){if("Enter"===t.key){var e=this.inputField.value;this.addMessage("You",e),this.socket.send(e),this.inputField.value=""}},this.addMessage=function(t,e){var i=document.createElement("div");i.innerHTML="<strong>"+t+":</strong> "+e,i.style.marginBottom="10px",this.messageList.appendChild(i),this.messageList.scrollTop=this.messageList.scrollHeight}};for(var t=0;t<window.mw.q.length;t++)window.mw[window.mw.q[t][0]].apply(window.mw,window.mw.q[t].slice(1))}();